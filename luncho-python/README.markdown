# Luncho client library for Python

- The client library is [./luncho_python/api/luncho.py](./luncho_python/api/luncho.py).

- Although there are files generated by OpenAPI generator, such as [./luncho_python/api/luncho_api.py](./luncho_python/api/luncho_api.py) and [README.md](./README.md), use [./luncho_python/api/luncho.py](./luncho_python/api/luncho.py) as it has required functions for data conversion and caching.


## Example

- See [../server/test/test_client_lib.py](../server/test/test_client_lib.py) for example.

## Usage

- Since a pypi package is not available yet, use a symlink.

```
    cd LOCATION
    git clone https://github.com/HIRANO-Satoshi/luncho.git
    cd luncho/luncho-python

    cd YOUR_SRC
    ln -s LOCATION/luncho/luncho-python/luncho_python .
```

```
    import luncho_python
    from luncho_python.api import luncho_api, luncho
    from luncho_python.model.luncho_data import LunchoData

    self.api_client = luncho_python.ApiClient(luncho_python.Configuration(
        host = "http://luncho-de-peace.org"  # "http://localhost:8000"
    ))
    self.luncho   = luncho.Luncho(self.api_client)

    # estimate country code from IP address
    const countryCode = self.luncho.get_country_code()

    #  Returns the local currency value of the country from the US dollar value in US, taking the
    #    price level of the country into account by factor 0 to 1.0.
    jpy = self.luncho.get_currency_from_US_dollar(50.0, 'JP', 1.0)

    # get the local currency value of the country from the Luncho value, taking the
    #    price level of the country into account by factor 0 to 1.0.
    jpy = self.luncho.get_currency_from_luncho(100.0, 'JP', 1.0)

    # get the Luncho value of the country from the local currency value.
    luncho_value = self.luncho.get_luncho_from_currency(50.0, 'JP', 1.0)

    # get the US Dollar value of the country from the Luncho value, taking the
    #    price level of the country into account by factor 0 to 1.0.
    usd = self.luncho.get_US_dollar_from_luncho(100.0, 'JP', 1.0)

    # Get a LunchoData to see info such as currency_code and exchange rate
    lunchoData: LunchoData = self.luncho.get_luncho_data('JP')

    # Get a dict of supported county codes and names
    data: Dict[CountryCode, str] = self.luncho.get_countries()

    # Load or get a dict of LunchoDatas for supported countries.  Data size is about 40KB.
    # If you show data of all countries, call this before in order to load all LunchoDatas at once,
    # or it loads LunchoData one by one and that is very slow.
    self.luncho.get_all_luncho_data()
```
- See comments for detail on [./luncho_python/api/luncho.py](./luncho_python/api/luncho.py).
 - Read auto-generated [README.md](./README.md), too.

## Cached data

  - You can use cached data inside self.luncho. Caution that these data will be gone when expired or
    reloaded.
  - These variables are available.

```
        self.luncho.lunchoDataCache: Dict[CountryCode, LunchoData] = {}  # Cache {CountryCode: LunchoData}
        self.luncho.allLunchoDatasExpiration: float = 0.0;
        self.luncho.countryCache: Dict[CountryCode, str] = {}       # { CountryCode: name }
```
